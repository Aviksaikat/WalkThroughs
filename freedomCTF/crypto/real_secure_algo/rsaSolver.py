#!/usr/bin/python3

"""
python code to compute the private exponent and perform decryption. 
It uses the extended euclidean algorithm
"""

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
        gcd = b
    return gcd, x, y

def main():

    p = 154833265287864773147552014146454599312068890831753284512828460430126699248457523802659588514026681128214053650438497343273025394743318733964873443274026991026780332720218883729707147917596349022483682184685004742585092793391156473316622746087897728753812324444792637715511727049511238794297089853301438777399
    q = 151878194389938560189069163089739370648688289991338373462637028639852135426872703365439691573289865242804011665493789019391074029361634356549953280562156637681978765654782189480200683011312795944169018578140587665839577362419899840303279812074690102322159175852795933782205415109683850800960872547481252314707
    e = 65537
    cipherText = 14776729025781105553112132174088306373390476280916520527770398579359413646310697390216130466313418986817051011104461186475905981968813033304005547115393765466582368390371049356338122788488731703429461292160411111638066563408009321303970526001514091436448050132714864147826845288569688873353652506654051020918158273519725581155221909111823071850143456325193228522236046210264679269446539520005628021809037198804014317258775644933283364434130199574514078051065906549005188510354686928222093728999343440377524451373750564840349382646108602632248806708858547802820321253635893330792322766745466421689414958073873651758186

    # compute n
    n = p * q

    # Compute phi(n)
    phi = (p - 1) * (q - 1)

    # Compute modular inverse of e
    gcd, a, b = egcd(e, phi)
    d = a

    #print("n: " + str(d) );

    # Decrypt ciphertext
    pt = pow(cipherText, d, n)
    #print()

    print("pt: " + str(pt))

if __name__ == "__main__":
    main()


#hex: 23D362A76C448E2F823B02375A6024A0D5CC3275455FFA155EAE69042FD5D4D249B1D6CAC0E3BC6B7E581
#base64: MjNEMzYyQTc2QzQ0OEUyRjgyM0IwMjM3NUE2MDI0QTBENUNDMzI3NTQ1NUZGQTE1NUVBRTY5MDQyRkQ1RDREMjQ5QjFENkNBQzBFM0JDNkI3RTU4MQ==
# 
