# TryHackMe Advent of Cyber 4

> Saikat Karmakar | Started Dec 1 : 2022 

---

## Task 6

1. Who is the adversary that attacked Santa's network this year? 
```
The Bandit Yeti
```

2. What's the flag that they left behind?
```
THM{IT'S A Y3T1 CHR1$TMA$}
```

## Task 7

1. Use the ls command to list the files present in the current directory. How many log files are present?
```
2
```
2. Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?
```
webserver.log
```
3. On what day was Santa's naughty and nice list stolen?
```
friday
```
4. What is the IP address of the attacker?
```
10.10.249.191
```
5. What is the name of the important list that the attacker stole from Santa?
```
santaslist.txt
```
6. Look through the log files for the flag. The format of the flag is: THM{}
```
THM{STOLENSANTASLIST}
```

## Task 8

1. What is the name of the Registrar for the domain santagift.shop?
```
NAMECHEAP INC
```
2. Find the website's source code (repository) on github.com and open the file containing sensitive credentials. Can you find the flag?
```
{THM_OSINT_WORKS}
```
3. What is the name of the file containing passwords?
```
config.php
```
4. What is the name of the QA server associated with the website?
```
qa.santagift.shop
```
5. What is the DB_PASSWORD that is being reused between the QA and PROD environments?
```
S@nta2022
```

## Task 9

1. What is the name of the HTTP server running on the remote host?
```
Apache
```
2. What is the name of the service running on port 22 on the QA server?
```
ssh
```
3. What flag can you find after successfully accessing the Samba service?
```
{THM_SANTA_SMB_SERVER}
```
4. What is the password for the username santahr?
```
santa25
```

## Task 10

1. Use Hydra to find the VNC password of the target with IP address 10.10.229.77. What is the password?
```
1q2w3e4r
```
2. Using a VNC client on the AttackBox, connect to the target of IP address 10.10.229.77. What is the flag written on the target’s screen?
```
THM{I_SEE_YOUR_SCREEN}
```

## Task 11

1. What is the email address of the sender? 
```
chief.elf@santaclaus.thm
```
2. What is the return address?
```
murphy.evident@bandityeti.thm
```
3. On whose behalf was the email sent? 
```
Chief Elf
```
4. What is the X-spam score? 
```
3
```
5. What is hidden in the value of the Message-ID field?
```
AoC2022_Email_Analysis
```
6. Visit the email reputation check website provided in the task. What is the reputation result of the sender's email address? 
```
Risky
```
7. Check the attachments. What is the filename of the attachment?
```
Division_of_labour-Load_share_plan.docRisky
```
8. What is the hash value of the attachment?
```
0827bb9a2e7c0628b82256759f0f888ca1abd6a2d903acdb8e44aca6a1a03467
```
9. Visit the Virus Total website and use the hash value to search. Navigate to the behaviour section. What is the second tactic marked in the Mitre ATT&CK section?
```
Defense Evasion
```
10. Visit the InQuest website and use the hash value to search. What is the subcategory of the file?
```
macro_hunter
```


## Task 12

1. What is the version of CyberChef found in the attached VM?
```
9.49.0
```
2. How many recipes were used to extract URLs from the malicious doc?
```
10
```
3. We found a URL that was downloading a suspicious file; what is the name of that malware?
```
mysterygift.exe
```
4. What is the last defanged URL of the bandityeti domain found in the last step?
```
hxxps[://]cdn[.]bandityeti[.]THM/files/index/
```
5. What is the ticket found in one of the domains? (Format: Domain/<GOLDEN_FLAG>)
```
THM_MYSTERY_FLAG
```

## Task 13

1. What flag is found after attacking the provided EtherStore Contract?
```
flag{411_ur_37h_15_m1n3}
``` 


## Task 14

1. Deploy the attached VM, and wait a few minutes. What ports are open?
```
80
```
2. What framework is the web application developed with?
```
laravel
```
3. What CVE is the application vulnerable to?
```
CVE-2021-3129
```
4. What command can be used to upgrade the last opened session to a Meterpreter session?
```
sessions -u -1
```
5. What file indicates a session has been opened within a Docker container?
```
/.dockerenv
```
6. What file often contains useful credentials for web applications?
```
.env
```
7. What database table contains useful credentials?
```
users
```
8. What is Santa's password?
```
p4$$w0rd
```
9. What ports are open on the host machine?
```
22,80
```
10. What is the root flag?
```
THM{47C61A0FA8738BA77308A8A600F88E4B}
```

## Task 15

1. What is the Guard's flag?
```

```
2. What is the Yeti's flag?
```

```


## Task 16

1. There is an open port related to MS SQL Server accessible over the network. What is the port number?
```
1433
```
2. If the connection is successful, you will get a prompt. What is the prompt that you have received?
```
1>
```
3. We can see four columns in the table displayed above: id, first (name), last (name), and nickname. What is the first name of the reindeer of id 9?
```
Rudolph
```
4. Check the table schedule. What is the destination of the trip scheduled on December 7?
```
Prague
```
5. Check the table presents. What is the quantity available for the present “Power Bank”?
```
25000
```
6. There is a flag hidden in the grinch user's home directory. What are its contents?
```
THM{YjtKeUy2qT3v5dDH}
```

## Task 17

1. Scan the target server with the IP MACHINE_IP. Remember that MS Windows hosts block pings by default, so we need to add -Pn, for example, nmap -Pn MACHINE_IP for the scan to work correctly. How many TCP ports are open?
```
7
```
2. In the scan results you received earlier, you should be able to spot NFS or mountd, depending on whether you used the -sV option with Nmap or not. Which port is detected by Nmap as NFS or using the mountd service?
```
2049
```
3. How many shares did you find?
```
4
```
4. How many shares show “everyone”?
```
3
```
5. What is the title of file 2680-0.txt?
```
Meditations
```
6. It seems that Grinch Enterprises has forgotten their SSH keys on our system. One of the shares contains a private key used for SSH authentication (id_rsa). What is the name of the share?
```
confidential
```
7. We can calculate the MD5 sum of a file using md5sum FILENAME. What is the MD5 sum of id_rsa?
```
3e2d315a38f377f304f5598dc2f044de
```

## Task 18

1. Complete the username: p.....
```
pepper
```
2. What is the OS version?
```
10.0.17763 N/A Build 17763
```
3. What backup service did you find running on the system?
```
IperiusSvc
```
4. What is the path of the executable for the backup service you have identified?
```
C:\Program Files (x86)\Iperius Backup\IperiusService.exe
```
5. Run the whoami command on the connection you have received on your attacking machine. What user do you have?
```
the-grinch-hack\thegrinch
```
6. What is the content of the flag.txt file?
```
THM-736635221
```
7. The Grinch forgot to delete a file where he kept notes about his schedule! Where can we find him at 5:30?
```
jazzercize
```

## Task 19

1. How many pages did the dirb scan find with its default wordlist?
```
4
```
2. How many scripts do you see in the /home/thegrinch/scripts folder?
```
4
```
3. What are the five characters following $6$G in pepper's password hash?
```
ZUP42
```
4. What is the content of the flag.txt file on the Grinch's user’s desktop?
```
DI3H4rdIsTheBestX-masMovie!
```

## Task 21

1. What is the operator's username?
```
GrinchWho31
```
2. What social media platform is the username associated with?
```
twitter
```
3. What is the cryptographic identifier associated with the operator?
```
1GW8QR7CWW3cpvVPGMCF5tZz4j96ncEgrVaR
```
4. What platform is the cryptographic identifier associated with?
```
Keybase.io
```
5. What is the bitcoin address of the operator?
```
bc1q5q2w2x6yka5gchr89988p2c8w8nquem6tndw2f
```
6. What platform does the operator leak the bitcoin address on? 
```
github
```
7. What is the operator's personal email?
```
DonteHeath21@gmail.com
```
8. What is the operator's real name?
```
Donte Heath
```

## Task 22

1. What is the name of the S3 Bucket used to host the HR Website announcement?
```
images.bestfestivalcompany.com
```
2. What is the message left in the flag.txt object from that bucket?
```
It's easy to get your elves data when you leave it so easy to find!
```
3. What other file in that bucket looks interesting to you?
```
wp-backup.zip
```
4. What is the AWS Access Key ID in that file?
```
AKIAQI52OJVCPZXFYAOI
```
5. What is the AWS Account ID that access-key works for?
```
019181489476
```
6. What is the Username for that access-key?
```
ElfMcHR@bfc.com
```
7. There is an EC2 Instance in this account. Under the TAGs, what is the Name of the instance?
```
HR-Portal
```
8. What is the database password stored in Secrets Manager?
```
Winter2021!
```

## Task 23

1. What command will list container images stored in your local container registry?
```
docker images
```
2. What command will allow you to save a docker image as a tar archive?
```
docker save
```
3. What is the name of the file (including file extension) for the configuration, repository tags, and layer hash values stored in a container image?
```
manifest.json
```
4. What is the token value you found for the bonus challenge?
```
7095b3e9300542edadbc2dd558ac11fa
```

## Task 24

1. Who was the email sent to? (Answer is the email address)
```
elfmcphearson@tbfc.com
```
2. Phishing emails use similar domains of their targets to increase the likelihood the recipient will be tricked into interacting with the email. Who does it say the email was from? (Answer is the email address)
```
customerservice@t8fc.info
```
3. Sometimes phishing emails have a different reply-to email address. If this email was replied to, what email address will receive the email response?
```
fisher@tempmailz.grinch
```
4. Less sophisticated phishing emails will have typos. What is the misspelled word?
```
stright
```
5. The email contains a link that will redirect the recipient to a fraudulent website in an effort to collect credentials. What is the link to the credential harvesting website?
```
https://89xgwsnmo5.grinch/out/fishing/
```
6. View the email source code. There is an unusual email header. What is the header and its value?
```
X-GrinchPhish: >;^)
```
7. You received other reports of phishing attempts from other colleagues. Some of the other emails contained attachments. Open attachment.txt. What is the name of the attachment?
```
password-reset-instaructions.pdf
```
8. What is the flag in the PDF file?
```
THM{A0C_Thr33_Ph1sh1ng_An4lys!s}
```

## Task 25

1. Open the terminal and navigate to the file on the desktop named 'testfile'. Using the 'strings' command, check the strings in the file. There is only a single line of output to the 'strings' command. What is the output?
```
X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
```
2. Check the file type of 'testfile' using the 'file' command. What is the file type?
```
EICAR virus test files
```
3. Calculate the file's hash and search for it on VirusTotal. When was the file first seen in the wild?
```
2005-10-17 22:03:48 
```
4. On VirusTotal's detection tab, what is the classification assigned to the file by Microsoft?
```
Virus:DOS/EICAR_Test_File
```
5. Go to this link to learn more about this file and what it is used for. What were the first two names of this file?
```
ducklin.htm or ducklin-html.htm
```
6. The file has 68 characters in the start known as the known string. It can be appended with whitespace characters upto a limited number of characters. What is the maximum number of total characters that can be in the file?
```
128
```

## Task 26

1. We changed the text in the string $a as shown in the eicaryara rule we wrote, from X5O to X50, that is, we replaced the letter O with the number 0. The condition for the Yara rule is $a and $b and $c and $d. If we are to only make a change to the first boolean operator in this condition, what boolean operator shall we replace the 'and' with, in order for the rule to still hit the file?
```
or
```
2. What option is used in the Yara command in order to list down the metadata of the rules that are a hit to a file? 
```
-m
```
3. What section contains information about the author of the Yara rule?
```
metadata
```
4. What option is used to print only rules that did not hit?
```
-n
```
5. Change the Yara rule value for the $a string to X50. Rerun the command, but this time with the -c option. What is the result?
```
0
```

## Task 27

1. What is the username (email address of Grinch Enterprises) from the decoded script?
```
Grinch.Enterprises.2021@gmail.com
```
2. What is the mailbox password you found?
```
S@ntai$comingt0t0wn
```
3. What is the subject of the email?
```
Christmas Wishlist
```
4. What port is the script using to exfiltrate data from the North Pole?
```
587
```
5. What is the flag hidden found in the document that Grinch Enterprises left behind? (Hint: use the following command oledump.py -s {stream number} -d, the answer will be in the caption).
```
YouFoundGrinchCookie
```
6. There is still a second flag somewhere... can you find it on the machine?
```
S@nt@c1Au$IsrEAl
```

## Task 28

1. What command was executed as Elf McNealy to add a new user to the machine?
```
Invoke-Nightmare
```
2. What user executed the PowerShell file to send the password.txt file from the administrator's desktop to a remote server?
```
adm1n
```
3. What was the IP address of the remote server? What was the port used for the remote connection? (format: IP,Port)
```
10.10.148.96,4321
```
4. What was the encryption key used to encrypt the contents of the text file sent to the remote server?
```
j3pn50vkw21hhurbqmxjlpmo9doiukyb
```
5. What application was used to delete the password.txt file?
```
sdelete.exe
```
6. What is the date and timestamp the logs show that password.txt was deleted? (format: MM/DD/YYYY H:MM:SS PM)
```
11/11/2021 7:29:27 PM
```
7. What were the contents of the deleted password.txt file?
```
Mission Control:letitsnowletitsnowletitsnow
```


## Task 29

1. What is the username of the other user on the system?
```
emily
```
2. What is the NTLM hash of this user?
```
8af326aa4850225b75c592d4ce19ccf5
```
3. What is the password for this user?
```
1234567890
```