# TryHackMe Advent of Cyber 4

> Saikat Karmakar | Started Dec 1 : 2022 

---

## Task 6

1. Who is the adversary that attacked Santa's network this year? 
```
The Bandit Yeti
```

2. What's the flag that they left behind?
```
THM{IT'S A Y3T1 CHR1$TMA$}
```

## Task 7

1. Use the ls command to list the files present in the current directory. How many log files are present?
```
2
```
2. Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?
```
webserver.log
```
3. On what day was Santa's naughty and nice list stolen?
```
friday
```
4. What is the IP address of the attacker?
```
10.10.249.191
```
5. What is the name of the important list that the attacker stole from Santa?
```
santaslist.txt
```
6. Look through the log files for the flag. The format of the flag is: THM{}
```
THM{STOLENSANTASLIST}
```

## Task 8

1. What is the name of the Registrar for the domain santagift.shop?
```
NAMECHEAP INC
```
2. Find the website's source code (repository) on github.com and open the file containing sensitive credentials. Can you find the flag?
```
{THM_OSINT_WORKS}
```
3. What is the name of the file containing passwords?
```
config.php
```
4. What is the name of the QA server associated with the website?
```
qa.santagift.shop
```
5. What is the DB_PASSWORD that is being reused between the QA and PROD environments?
```
S@nta2022
```

## Task 9

1. What is the name of the HTTP server running on the remote host?
```
Apache
```
2. What is the name of the service running on port 22 on the QA server?
```
ssh
```
3. What flag can you find after successfully accessing the Samba service?
```
{THM_SANTA_SMB_SERVER}
```
4. What is the password for the username santahr?
```
santa25
```

## Task 10

1. Use Hydra to find the VNC password of the target with IP address 10.10.229.77. What is the password?
```
1q2w3e4r
```
2. Using a VNC client on the AttackBox, connect to the target of IP address 10.10.229.77. What is the flag written on the targetâ€™s screen?
```
THM{I_SEE_YOUR_SCREEN}
```

## Task 11

1. What is the email address of the sender? 
```
chief.elf@santaclaus.thm
```
2. What is the return address?
```
murphy.evident@bandityeti.thm
```
3. On whose behalf was the email sent? 
```
Chief Elf
```
4. What is the X-spam score? 
```
3
```
5. What is hidden in the value of the Message-ID field?
```
AoC2022_Email_Analysis
```
6. Visit the email reputation check website provided in the task. What is the reputation result of the sender's email address? 
```
Risky
```
7. Check the attachments. What is the filename of the attachment?
```
Division_of_labour-Load_share_plan.docRisky
```
8. What is the hash value of the attachment?
```
0827bb9a2e7c0628b82256759f0f888ca1abd6a2d903acdb8e44aca6a1a03467
```
9. Visit the Virus Total website and use the hash value to search. Navigate to the behaviour section. What is the second tactic marked in the Mitre ATT&CK section?
```
Defense Evasion
```
10. Visit the InQuest website and use the hash value to search. What is the subcategory of the file?
```
macro_hunter
```


## Task 12

1. What is the version of CyberChef found in the attached VM?
```
9.49.0
```
2. How many recipes were used to extract URLs from the malicious doc?
```
10
```
3. We found a URL that was downloading a suspicious file; what is the name of that malware?
```
mysterygift.exe
```
4. What is the last defanged URL of the bandityeti domain found in the last step?
```
hxxps[://]cdn[.]bandityeti[.]THM/files/index/
```
5. What is the ticket found in one of the domains? (Format: Domain/<GOLDEN_FLAG>)
```
THM_MYSTERY_FLAG
```

## Task 13

1. What flag is found after attacking the provided EtherStore Contract?
```
flag{411_ur_37h_15_m1n3}
``` 


## Task 14

1. Deploy the attached VM, and wait a few minutes. What ports are open?
```
80
```
2. What framework is the web application developed with?
```
laravel
```
3. What CVE is the application vulnerable to?
```
CVE-2021-3129
```
4. What command can be used to upgrade the last opened session to a Meterpreter session?
```
sessions -u -1
```
5. What file indicates a session has been opened within a Docker container?
```
/.dockerenv
```
6. What file often contains useful credentials for web applications?
```
.env
```
7. What database table contains useful credentials?
```
users
```
8. What is Santa's password?
```
p4$$w0rd
```
9. What ports are open on the host machine?
```
22,80
```
10. What is the root flag?
```
THM{47C61A0FA8738BA77308A8A600F88E4B}
```

## Task 15

1. What is the Guard's flag?
```
THM{5_star_Fl4gzzz}
```
2. What is the Yeti's flag?
```
THM{yetiyetiyetiflagflagflag}
```


## Task 16

1. What is the Windows version number that the memory image captured?
```
10
```
2. What is the name of the binary/gift that secret Santa left?
```
mysterygift.exe
```
3. What is the Process ID (PID) of this binary?
```
2040
```
4. Dump the contents of this binary. How many files are dumped?
```
16
```


## Task 17

1. What is the architecture of the malware sample? (32-bit/64-bit)
```
64-bit
```
2. What is the packer used in the malware sample? (format: lowercase)
```
upx
```
3. What is the compiler used to build the malware sample? (format: lowercase)
```
nim
```
4. How many MITRE ATT&CK techniques have been discovered attributed to the DISCOVERY tactic?
```
2
```
5. What is the registry key abused by the malware?
```
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
```
6. What is the value written on the registry key based on the previous question?
```
C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\wishes.bat
```
7. What are the names of two files created by the malware under the C:\Users\Administrator\ directory? (format: file1,file2 in alphabetical order)
```
test.jpg, wishes.bat
```
8. What are the two domains wherein malware has initiated a network connection? (format: domain1,domain2 in alphabetical order)
```
bestfestivalcompany.thm, virustotal.com
```
9. Going back to strings inside the malware sample, what is the complete URL used to download the file hosted in the first domain accessed by the malware?
```
http://bestfestivalcompany.thm/favicon.ico
```

## Task 18

1. What is the "Percent Packets" value of the "Hypertext Transfer Protocol"?
```
0.3
```
2. Which port number has received more than 1000 packets?
```
3389
```
3. What is the service name of the used protocol that received more than 1000 packets?
```
rdp
```
4. What are the domain names?
```
bestfestivalcompany[.]thm, cdn[.]bandityeti[.]thm
```
5. What are the names of the requested files?
```
favicon[.]ico, mysterygift[.]exe
```
5. Which IP address downloaded the executable file?
```
10[.]10[.]29[.]186	
```
6. Which domain address hosts the malicious file?
```
cdn[.]bandityeti[.]thm
```
7. What is the "user-agent" value used to download the non-executable file?
```
Nim httpclient/1.6.8
```
8. What is the sha256 hash value of the executable file?
```
0ce160a54d10f8e81448d0360af5c2948ff6a4dbb493fe4be756fc3e2c3f900f
```
9. What are the connected IP addresses? Enter the IP addressed defanged and in numerical order. (format: IPADDR,IPADDR)
```
20[.]99[.]133[.]109, 20[.]99[.]184[.]37, 23[.]216[.]147[.]76
```

## Task 19

1. What is the office number of Elf Pivot McRed?
```
134
```
2. Not only profile pages but also stored images are vulnerable. Start with a URL of a valid profile image; what is the hidden flag?
```
THM{CLOSE_THE_DOOR}
```

## Task 20

1. What is the name given to file uploads that allow threat actors to upload any files that they want?
```
Unrestricted
```
2. What is the title of the web application developed by Santa's freelancer?
```
SantaSideKick2
```
3. What is the value of the flag stored in the HR Elf's Documents directory?
```
THM{Naughty.File.Uploads.Can.Get.You.RCE}
```
4. What defence technique can be implemented to ensure that specific file types can be uploaded?
```
File Extension Validation
```
5. What defence technique can be used to make sure the threat actor cannot recover their file again by simply using the file name?
```
File Renaming
```
6. What defence technique can be used to make sure malicious files that can hurt elves are not uploaded?
```
Malware Scanning
```

## Task 21

1. What is the value of Flag1?
```
THM{McCode, Elf McCode}
```
2. What is the value of Flag2?
```
THM{KodeNRoll}
```
3. What is the value of Flag3?
```
THM{Are we secure yet?}
```
4. What is the value of Flag4?
```
THM{SQLi_who???}
```

## Task 22

1. Filtering for Usernames: How many usernames fit the syntax above?

```

```
2. Filtering for Usernames: One username consists of a readable word concatenated with a number. What is it?
```

```
3. Filtering for Emails: How many emails fit the syntax above?
```

```
4. Filtering for Emails: How many unique domains are there?
```

```
5. Filtering for Emails: What is the domain of the email with the local-part "lewisham44"?
```

```
6. Filtering for Emails: What is the domain of the email with the local-part "maxximax"?
```

```
7. Filtering for Emails: What is the local-part of the email with the domain name "hotmail.com"?
```

```
8. Filtering for URLs: How many URLs fit the syntax provided?
```

```
9. Filtering for URLs: How many of these URLs start with "https"?
```

```

## Task 23

1. What is the Challenge #1 flag?
```

```
2. From the Challenge 1 log, what user account was created?
```

```
3. What is the Challenge #2 flag?
```

```
4. What was the User's path in the Challenge #2 log file?
```

```
5. What is the Challenge #3 flag?
```

```
6. What was the MD5 hash associated with Challenge #3 logs?
```
2F6CE97FAF2D5EEA919E4393BDD416A7
```
## Task 24

1. What device can be used to probe the signals being sent on electrical wires between two devices?
```

```
2. USART is faster than SPI for communication? (Yea,Nay)
```

```
3. USART communication uses fewer wires than SPI? (Yea,Nay)
```

```
4. USART is faster than I2C for communication? (Yea,Nay)
```

```
5. I2C uses more wires than SPI for communication? (Yea,Nay)
```

```
6. SPI is faster than I2C for communication? (Yea,Nay)
```

```
7. What is the maximum number of devices that can be connected on a single pair of I2C lines?
```

```
8. What is the new baud rate that is negotiated between the microprocessor and ESP32 chip?
```

```
9. What is the flag that is transmitted once the new baud rate was accepted?
```
THM{Hacking.Hardware.Is.Fun}
```
## Task 25

1. What is the flag value after reversing the file firmwarev2.2-encrypted.gpg?
```

```
2. What is the Paraphrase value for the binary firmwarev1.0_unsigned?
```

```
3. After reversing the encrypted firmware, can you find the build number for rootfs?
```

```
## Task 26

1. What port is Mosquitto running on? 
```

```
2. Is the device/init topic enumerated by Nmap during a script scan of all ports? (y/n)
```

```
3. What Mosquitto version is the device using?
```

```
4. What flag is obtained from viewing the RTSP stream? 
```

```
## Task 27

1. Follow the instructions in the attached static site to help McSkidy reduce her attack surface against attacks from the Yeti. Use the flag as an answer to complete the task. 
```
THM{4TT4CK SURF4C3 R3DUC3D}
```

## Task 28

1. Case 1: What is the password for Santaâ€™s Vault?
```

```
2. Case 1: What is the Flag?
```

```
3. Case 2: What is Santaâ€™s favourite thing?
```

```
4. Case 2: What is the password for Santaâ€™s Vault?
```

```
5. Case 2: What is the Flag?
```

```
6. Case 3: What is the Executive Assistantâ€™s favourite thing?
```

```
7. Case 3: What is Santaâ€™s previous password?
```

```
8. Case 3: What is Santaâ€™s current password?
```

```
9. Case 3: What is the 1st part of the vaultâ€™s password?
```

```
10. Case 3: What is the 2nd part of the vaultâ€™s password?
```

```
11. Case 3: What is the password for Santaâ€™s Vault?
```

```
12. Case 3: What is the Flag?
```

```
13. What is Santa's Code?
```

```
14. Mission ELFPossible: What is the Abominable for a Day Flag?
```

```
